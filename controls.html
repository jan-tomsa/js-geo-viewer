<html>
<head>
<style type="text/css">
@import "css/jquery.svg.css";


#svgbasics { width: 400px; height: 300px; border: 1px solid #484; }
</style>
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="js/jquery.svg.js"></script>
<script type="text/javascript">
$(function() {
	$('#svgbasics').svg({onLoad: drawInitial});
	$('#rect,#line,#circle,#ellipse').click(drawShape);
	$('#drawLines').click(drawLines);
	$('#clear').click(function() {
		$('#svgbasics').svg('get').clear();
	});
	$('#export').click(function() {
		var xml = $('#svgbasics').svg('get').toSVG();
		$('#svgexport').html(xml.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'));
	});
});

function drawInitial(svg) {
	svg.circle(75, 75, 50, {fill: 'none', stroke: 'red', 'stroke-width': 3});
	var g = svg.group({stroke: 'black', 'stroke-width': 2});
	svg.line(g, 15, 75, 135, 75);
	svg.line(g, 75, 15, 75, 135);
}

var colours = ['purple', 'red', 'orange', 'yellow', 'lime', 'green', 'blue', 'navy', 'black'];

function drawLines() {
	var myScript = $('#myScript')[0].value;
	var scriptLines = myScript.split("\n");
	var coordinates = [];
	lastx = 0;
	lasty = 0;
	for (line in scriptLines) {
		coords = scriptLines[line].trim().split(" ");
		if (coords.length > 3) {
		  x1 = 1*coords[0];
		  y1 = 1*coords[1];
		  x2 = 1*coords[2];
		  y2 = 1*coords[3];
		  coordinates.push([x1,y1,x2,y2]);
		  lastx = x2;
		  lasty = y2;
		} else if (coords.length == 2) {
		  x2 = 1*coords[0];
		  y2 = 1*coords[1];
		  coordinates.push([lastx,lasty,x2,y2]);
		  lastx = x2;
		  lasty = y2;
		}
	}
	drawSVGLines( coordinates )
}

function drawSVGLines( coordinates ) {
	var svg = $('#svgbasics').svg('get');
	for (lineCoords in coordinates) {
		lc = coordinates[lineCoords];
		svg.line(lc[0], lc[1], lc[2], lc [3], {stroke: 'green', 'stroke-width': 1});
	}
}

function drawShape() {
	var shape = this.id;
	var svg = $('#svgbasics').svg('get');
	if (shape == 'rect') {
		svg.rect(random(300), random(200), random(100) + 100, random(100) + 100,
			{fill: colours[random(9)], stroke: colours[random(9)],
			'stroke-width': random(5) + 1});
	}
	else if (shape == 'line') {
		svg.line(random(400), random(300), random(400), random(300),
			{stroke: colours[random(9)], 'stroke-width': random(5) + 1});
	}
	else if (shape == 'circle') {
		svg.circle(random(300) + 50, random(200) + 50, random(80) + 20,
			{fill: colours[random(9)], stroke: colours[random(9)],
			'stroke-width': random(5) + 1});
	}
	else if (shape == 'ellipse') {
		svg.ellipse(random(300) + 50, random(200) + 50, random(80) + 20, random(80) + 20,
			{fill: colours[random(9)], stroke: colours[random(9)],
			'stroke-width': random(5) + 1});
	}
}

function random(range) {
	return Math.floor(Math.random() * range);
}
</script>
	<script type="text/javascript">
	function changeSrc( newSrc )
	{
		document.getElementById("contents").src=newSrc
		//parent["contentsPanel"].location.href = newSrc;
		//parent.urlPanel.document.forms.urlForm.urlText.value = newSrc;
	}

	function displayMap()
	{
		x1 = document.forms.frm1.x1.value;
		x2 = document.forms.frm1.x2.value;
		y1 = document.forms.frm1.y1.value;
		y2 = document.forms.frm1.y2.value;
		layers = document.forms.frm1.layers.value;
		width = y1-y2
		height = x1-x2
		imgWidth = parseInt(600*width/height)
		//alert("imgWidth:"+imgWidth)
		src = "http://wms.cuzk.cz/wms.asp?SERVICE=WMS&VERSION=1.1.1&REQUEST=GetMap&LAYERS="+layers+"&FORMAT=image/png&SRS=EPSG:102067&STYLES=&BBOX=" +y1+ "," + x1 + "," + y2 + "," + x2 + "&WIDTH="+imgWidth+"&HEIGHT=600"
		changeSrc( src );
	}

	function preset(y1,x1,y2,x2)
	{
		document.forms.frm1.x1.value = x1;
		document.forms.frm1.x2.value = x2;
		document.forms.frm1.y1.value = y1;
		document.forms.frm1.y2.value = y2;
	}
	</script>
</head>
<body>
	<table>
		<tr>
			<td>
	<a href="controls.html">Refresh</a>
	<!--a href="contents.html" target="contentsPanel">Init</a-->
	<form name="frm1">
		Y1: <input type="text" name="y1" value="-526406.630944882">(left)<br/>
		X1: <input type="text" name="x1" value="-1152817.98062992">(bottom)<br/>
		Y2: <input type="text" name="y2" value="-526216.079763779">(right)<br/>
		X2: <input type="text" name="x2" value="-1152717.98062992">(top)<br/>
		(0,0 je nìkde v Estonsku)
		<input type="button" value="Display" onClick="displayMap()">
		<hr>
		<strong>Layers:</strong>
		<input type="text" name="layers" value="prehledka_kat_prac,dalsi_p_mapy,hranice_parcel,obrazy_parcel,parcelni_cisla,prehledka_kat_uz,prehledka_kraju-linie,RST_KMD,RST_KN">
		<ul>
			<li>prehledka_kat_prac</li>
			<li><strong>dalsi_p_mapy</strong></li>
			<li><strong>hranice_parcel</strong></li>
			<li><strong>obrazy_parcel</strong></li>
			<li><strong>parcelni_cisla</strong></li>
			<li>prehledka_kat_uz</li>
			<li>prehledka_kraju-linie</li>
			<li>RST_KMD</li>
			<li>RST_KN</li>
		</ul>
	</form>
	<hr>
	<strong>Presets:</strong>
	<ul>
		<li><a name="x" href="javascript:preset(-526406.630944882,-1152817.98062992,-526216.079763779,-1152717.98062992)">Kostel</a></li>
		<li><a name="x" href="javascript:preset(-739622.340,-1044729.140,-739599.190,-1044697.3)">Vinohrady</a></li>
		<li><a name="x" href="javascript:preset(-977587.94488189,-1243857,    -358590.05511811,-919011)">ÈR</a></li>
		<li><a name="x" href="javascript:preset(-751953.740,     -1050784.170,-751938.000,    -1050779.690)">k.ú.(745278)</a></li>
		<li><a name="x" href="javascript:preset(-729005.590,     -1058077.680,-724288.470,    -1053889.500)">Øíèany u Prahy</a></li>
		<li><a name="x" href="javascript:preset(-727280.85,      -1055672.75, -725083.79,     -1053948.53)">Øíèany-Radošovice</a></li>
		<li><a name="x" href="javascript:preset(-727080.85,-1055072.75,-726083.79,-1054048.53)">Øíèany-Radošovice2</a></li>
		<li><a name="x" href="javascript:preset(-726450.670,-1054907.860,-726300.670,-1054807.860)">Parcela 95/8</a></li>
		<li><a name="x" href="javascript:preset(-726450.67,-1054900,-726300.67,-1054810)">Parcela 95/8(closer)</a></li>
		<li><a name="x" href="javascript:preset(-739622.34,-1044729.14,-739599.19,-1044697.3)">Vinohrady è.p.2460</a></li>
		<li><a name="x" href="javascript:preset(-741851.41,-1050344.02,-741836.57,-1050332.61)">Lhotka è.p. 835</a></li>
		<li><a name="x" href="javascript:preset(-739569.560,-1044657.710,-739469.560,-1044557.710)">Vinohrady è.p.2460</a></li>
	</ul>
	<hr />
	<h3>SVG:</h3>
	<p>Coordinates script:</p>
	<textarea id="myScript">120 120 240 240</textarea>
<div id="svgbasics"></div>
<p><button id="drawLines">Draw Lines</button></p>
<p><button id="rect">Add rectangle</button>
   <button id="line">Add line</button>
   <button id="circle">Add circle</button>
   <button id="ellipse">Add ellipse</button>
   <button id="clear">Clear</button>
   <button id="export">Export</button>
</p>
<div id="svgexport"></div>
			</td>
			<td valign="top">
	<img id="contents" src="http://docutils.sourceforge.net/docs/user/images/rsp-empty.png" width="900" height="700" />
			</td>
		</tr>
	</table>
</body>
</html>
